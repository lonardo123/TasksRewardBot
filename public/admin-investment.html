<body>

<h2>âš™ï¸ Investment Admin</h2>

<div class="card">
  <h3>ğŸ’° Change Stock Price</h3>
  <input id="price" placeholder="New price">
  <button onclick="setPrice()">Update Price</button>
</div>

<div class="card">
  <h3>ğŸ”’ Max Buy Limit</h3>
  <input id="max" placeholder="Max stocks">
  <button onclick="setMax()">Update Limit</button>
</div>

<!-- Ù‡Ù†Ø§ ØªØ¶ÙŠÙ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
<div class="card">
  <h3>ğŸ“Š Users Stocks</h3>
  <table id="usersTable" border="1" width="100%" style="border-collapse:collapse;color:#fff;">
    <thead>
      <tr>
        <th>User</th>
        <th>Balance ($)</th>
        <th>Total Stocks</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Ø§Ù„Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª ÙÙŠ Ø¢Ø®Ø± Ø§Ù„ØµÙØ­Ø© -->
<script>
function setPrice(){
  const v = document.getElementById("price").value;
  fetch('/admin/set-price',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({price:v})
  }).then(r=>r.json()).then(alert);
}

function setMax(){
  const v = document.getElementById("max").value;
  fetch('/admin/set-max',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({max:v})
  }).then(r=>r.json()).then(alert);
}

// Ù‡Ù†Ø§ ØªØ¶ÙŠÙ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¬Ø¯ÙˆÙ„
async function loadUsersStocks(){
  const res = await fetch('/admin/users-stocks');
  const users = await res.json();

  const tbody = document.querySelector("#usersTable tbody");
  tbody.innerHTML = "";
  users.forEach(u=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${u.name}</td><td>${u.balance}</td><td>${u.totalStocks}</td>`;
    tbody.appendChild(tr);
  });
}

// Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
loadUsersStocks();
</script>

</body>
